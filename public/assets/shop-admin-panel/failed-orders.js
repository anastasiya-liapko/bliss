!function(c){function e(e){for(var t,n,a=e[0],l=e[1],r=e[2],o=0,i=[];o<a.length;o++)n=a[o],u[n]&&i.push(u[n][0]),u[n]=0;for(t in l)Object.prototype.hasOwnProperty.call(l,t)&&(c[t]=l[t]);for(f&&f(e);i.length;)i.shift()();return d.push.apply(d,r||[]),s()}function s(){for(var e,t=0;t<d.length;t++){for(var n=d[t],a=!0,l=1;l<n.length;l++){var r=n[l];0!==u[r]&&(a=!1)}a&&(d.splice(t--,1),e=o(o.s=n[0]))}return e}var n={},u={2:0},d=[];function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return c[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=c,o.c=n,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var t=window.webpackJsonp=window.webpackJsonp||[],a=t.push.bind(t);t.push=e,t=t.slice();for(var l=0;l<t.length;l++)e(t[l]);var f=a;d.push([204,0]),s()}({204:function(e,t,n){"use strict";n.r(t);var p=n(0),b=n.n(p),a=n(10),l=n.n(a),y=n(32),_=n(15),E=n(33),v=n(34),g=n(2);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var C=function(){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?c(e):t}(this,i(n).call(this,e))).handleTableRowClick=t.handleTableRowClick.bind(c(t)),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(n,p["Component"]),function(e,t,n){t&&o(e.prototype,t),n&&o(e,n)}(n,[{key:"handleTableRowClick",value:function(){var e=this.props.item;this.props.onTableRowClick(e.id)}},{key:"render",value:function(){var e=this.props,t=e.item;e.hasEditButton;return b.a.createElement("tr",{onClick:this.handleTableRowClick,className:"table_tr"},b.a.createElement("td",null,t.order_id_in_shop),b.a.createElement("td",null,g.a.localizeDate(t.time_of_creation)),b.a.createElement("td",null,g.a.normalizeGoods(t.goods)),b.a.createElement("td",null,g.a.localizeNumber(t.order_price)," руб."),b.a.createElement("td",null,g.a.getOrderStatusName(t.status)))}}]),n}();function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var k=function(){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?m(e):t}(this,f(n).call(this,e))).handleFilterCloseClick=t.handleFilterCloseClick.bind(m(t)),t.handleTableSortClick=t.handleTableSortClick.bind(m(t)),t.handleTableFilterClick=t.handleTableFilterClick.bind(m(t)),t.handleTableRowClick=t.handleTableRowClick.bind(m(t)),t.handlePageClick=t.handlePageClick.bind(m(t)),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(n,p["Component"]),function(e,t,n){t&&d(e.prototype,t),n&&d(e,n)}(n,[{key:"handleFilterCloseClick",value:function(){this.props.onFilterCloseClick()}},{key:"handleTableSortClick",value:function(e){this.props.onTableSortClick(e)}},{key:"handleTableFilterClick",value:function(e,t,n){this.props.onTableFilterClick(e,t,n)}},{key:"handleTableRowClick",value:function(e){this.props.onTableRowClick(e)}},{key:"handlePageClick",value:function(e){this.props.onPageClick(e)}},{key:"render",value:function(){var t=this,e=this.props,n=e.error,a=e.isLoading,l=e.items,r=e.orderBy,o=e.isDescending,i=e.filterBy,c=e.filterName,s=e.filterStart,u=e.filterEnd,d=e.totalItems,f=e.totalSum,m=e.pageCount,h=e.offset;return n?b.a.createElement("div",{className:"mt-4"},"Произошла ошибка. Перезагрузите страницу, возможно, вы не авторизированы в административной панели."):a?b.a.createElement("div",{className:"loading-container"},b.a.createElement("div",null,b.a.createElement("i",{className:"fas fa-sync fa-spin fa-3x","aria-hidden":!0}))):b.a.createElement(p.Fragment,null,b.a.createElement(y.a,{filterName:c,filterBy:i,filterStart:s,filterStartNames:{status:{declined_by_shop:"Отклонён магазином",canceled_by_client_upon_receipt:"Отменён покупателем при получении",declined_by_mfi:"Отклонён ФО",canceled_by_client:"Отклонён покупателем"}},filterEnd:u,onFilterClose:this.handleFilterCloseClick}),b.a.createElement("div",{className:"table-responsive-xl"},b.a.createElement("table",{className:"table table_sticky-header table-striped table-bordered table-hover"},b.a.createElement("thead",null,b.a.createElement("tr",null,b.a.createElement(_.a,{name:"№ заказа",slug:"order_id_in_shop",active:"order_id_in_shop"===r,isDescending:o,filterInputType:"text",showSort:!0,showFilter:!0,onTableSortClick:this.handleTableSortClick,onTableFilterClick:this.handleTableFilterClick}),b.a.createElement(_.a,{name:"Дата и время заказа",slug:"time_of_creation",active:"time_of_creation"===r,isDescending:o,filterInputType:"date",showSort:!0,showFilter:!0,onTableSortClick:this.handleTableSortClick,onTableFilterClick:this.handleTableFilterClick}),b.a.createElement("th",{className:"table__th"},"Состав заказа"),b.a.createElement("th",{className:"table__th"},"Сумма заказа"),b.a.createElement(_.a,{name:"Статус заказа",slug:"status",active:"status"===r,isDescending:o,filterInputType:"select",values:[{slug:"declined_by_shop",name:"Отклонён магазином"},{slug:"canceled_by_client_upon_receipt",name:"Отменён покупателем при получении"},{slug:"declined_by_mfi",name:"Отклонён ФО"},{slug:"canceled_by_client",name:"Отклонён покупателем"}],showSort:!0,showFilter:!0,onTableSortClick:this.handleTableSortClick,onTableFilterClick:this.handleTableFilterClick}))),b.a.createElement("tbody",null,l.map(function(e){return b.a.createElement(C,{key:e.id,item:e,onTableRowClick:t.handleTableRowClick})})))),b.a.createElement(v.a,{total:d,totalSum:f}),b.a.createElement(E.a,{pageCount:m,offset:h,perPage:10,onPageClick:this.handlePageClick}))}}]),n}();function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var P=function(){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?N(e):t}(this,T(n).call(this,e))).state={error:null,isGoodsTableCollapsed:!0},t.handleCloseItem=t.handleCloseItem.bind(N(t)),t.handleTableCollapse=t.handleTableCollapse.bind(N(t)),t.renderCustomerBlock=t.renderCustomerBlock.bind(N(t)),t.renderCreditBlock=t.renderCreditBlock.bind(N(t)),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(n,p["Component"]),function(e,t,n){t&&w(e.prototype,t),n&&w(e,n)}(n,[{key:"handleCloseItem",value:function(){this.props.onClose()}},{key:"handleTableCollapse",value:function(){this.setState({isGoodsTableCollapsed:!this.state.isGoodsTableCollapsed})}},{key:"renderCustomerBlock",value:function(){var e=this.props.item;return e.customer_name||e.customer_phone||e.customer_additional_phone?b.a.createElement("div",{className:"mb-3"},b.a.createElement("h4",{className:"h5"},"Данные покупателя"),b.a.createElement("div",{className:"table-responsive"},b.a.createElement("table",{className:"table table-sm table-striped table-bordered"},b.a.createElement("tbody",null,!!e.customer_name&&b.a.createElement("tr",null,b.a.createElement("td",null,"Имя"),b.a.createElement("td",null,e.customer_name)),!!e.customer_phone&&b.a.createElement("tr",null,b.a.createElement("td",null,"Номер телефона"),b.a.createElement("td",null,e.customer_phone)),!!e.customer_additional_phone&&b.a.createElement("tr",null,b.a.createElement("td",null,"Доп. номер телефона"),b.a.createElement("td",null,e.customer_additional_phone)))))):null}},{key:"renderCreditBlock",value:function(){var e=this.props.item;return e.request_id||e.mfi_name||e.mfi_contract_id||e.mfi_customer_id?b.a.createElement("div",{className:"mb-3"},b.a.createElement("h4",{className:"h5"},"Данные по кредиту"),b.a.createElement("div",{className:"table-responsive"},b.a.createElement("table",{className:"table table-sm table-striped table-bordered"},b.a.createElement("tbody",null,!!e.request_id&&b.a.createElement("tr",null,b.a.createElement("td",null,"Заявка на кредит"),b.a.createElement("td",null,"№ ",e.request_id)),!!e.mfi_name&&b.a.createElement("tr",null,b.a.createElement("td",null,"ФО, одобрившая кредит"),b.a.createElement("td",null,e.mfi_name)),!!e.mfi_contract_id&&b.a.createElement("tr",null,b.a.createElement("td",null,"Номер кредита в ФО"),b.a.createElement("td",null,e.mfi_contract_id)),!!e.mfi_customer_id&&b.a.createElement("tr",null,b.a.createElement("td",null,"Идентификатор покупателя в ФО"),b.a.createElement("td",null,e.mfi_customer_id)))))):null}},{key:"render",value:function(){var n=this,e=this.props,t=e.error,a=e.isLoading,l=e.item;return t?b.a.createElement("div",{className:"mt-4"},"Произошла ошибка. Перезагрузите страницу, возможно, вы не авторизированы в административной панели."):a?b.a.createElement("div",{className:"loading-container"},b.a.createElement("div",null,b.a.createElement("i",{className:"fas fa-sync fa-spin fa-3x","aria-hidden":!0}))):b.a.createElement(p.Fragment,null,b.a.createElement("div",{className:"row mt-3"},b.a.createElement("div",{className:"col-sm-9"},b.a.createElement("div",{className:"bg-white p-3"},b.a.createElement("div",{className:"row mb-4"},b.a.createElement("div",{className:"col-1"},b.a.createElement("button",{type:"button",title:"Закрыть",className:"btn btn-sm btn-secondary",onClick:this.handleCloseItem},b.a.createElement("i",{className:"fas fa-times","aria-hidden":!0}))),b.a.createElement("div",{className:"col-7"},b.a.createElement("h2",{className:"h4"},"Заказ ",b.a.createElement("span",{className:"badge badge-light"},"№ ",l.order_id_in_shop),"  от ",b.a.createElement("span",{className:"badge badge-light"},g.a.localizeDate(l.time_of_creation)),"  на сумму ",b.a.createElement("span",{className:"badge badge-light"},g.a.localizeNumber(l.order_price)," руб."))),b.a.createElement("div",{className:"col-4"},b.a.createElement("div",{className:"text-right"},b.a.createElement("span",{className:"badge badge-primary badge_status text-wrap text-left"},g.a.getOrderStatusName(l.status))))),!!l.delivery_service_name&&b.a.createElement("div",{className:"mb-5"},b.a.createElement("div",{className:"table-responsive"},b.a.createElement("table",{className:"table table-sm table-striped table-bordered"},b.a.createElement("tbody",null,!!l.delivery_service_name&&b.a.createElement("tr",null,b.a.createElement("td",null,"Логистическая компания"),b.a.createElement("td",null,l.delivery_service_name)),!!l.tracking_code&&b.a.createElement("tr",null,b.a.createElement("td",null,"Трек-номер"),b.a.createElement("td",null,l.tracking_code)))))),b.a.createElement("div",{className:"mb-4"},b.a.createElement("h4",{className:"h5"},"Состав заказа"),b.a.createElement("div",{className:"table-responsive"},b.a.createElement("table",{className:"table table-sm table-striped table-bordered"},b.a.createElement("thead",null,b.a.createElement("tr",null,b.a.createElement("th",null,"Наименование товара"),b.a.createElement("th",null,"Цена товара"),b.a.createElement("th",null,"Кол-во"))),b.a.createElement("tbody",null,l.goods.map(function(e,t){return b.a.createElement("tr",{key:e.name,className:2<t&&n.state.isGoodsTableCollapsed?"d-none":""},b.a.createElement("td",null,e.name),b.a.createElement("td",null,g.a.localizeNumber(e.price)," руб."),b.a.createElement("td",null,e.quantity))})))),3<l.goods.length&&b.a.createElement("div",null,b.a.createElement("button",{className:"btn btn-sm btn-secondary",onClick:this.handleTableCollapse},this.state.isGoodsTableCollapsed?"Развернуть":"Свернуть"))),this.renderCustomerBlock(),this.renderCreditBlock()))))}}]),n}();function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var x=function(){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?B(e):t}(this,F(n).call(this,e))).state={error:null,isLoading:!1,item:[],showItem:!1,items:[],orderBy:"",filterBy:"",filterStart:"",filterEnd:"",isDescending:!0,total:0,totalSum:0,pageCount:0,offset:0},t.fetchItems=t.fetchItems.bind(B(t)),t.fetchItem=t.fetchItem.bind(B(t)),t.handlePageClick=t.handlePageClick.bind(B(t)),t.handleSort=t.handleSort.bind(B(t)),t.handleFilter=t.handleFilter.bind(B(t)),t.handleFilterClose=t.handleFilterClose.bind(B(t)),t.handleShowItem=t.handleShowItem.bind(B(t)),t.handleCloseItem=t.handleCloseItem.bind(B(t)),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(n,p["Component"]),function(e,t,n){t&&I(e.prototype,t),n&&I(e,n)}(n,[{key:"componentDidMount",value:function(){var e=this;this.setState({isLoading:!0},function(){e.fetchItems()})}},{key:"fetchItems",value:function(){var t=this,e=this.state,n=e.offset,a=e.orderBy,l=e.filterBy,r=e.filterStart,o=e.filterEnd,i=e.isDescending,c="".concat(g.a.getLocation(),"/shop-admin-panel/failed-orders/get-failed-orders")+"?per_page=".concat(this.props.perPage)+"&offset=".concat(n)+"&sort=".concat(i?"desc":"asc")+"&sort_by=".concat(a)+"&filter_by=".concat(l)+"&filter_start=".concat(r)+"&filter_end=".concat(o);fetch(c,{headers:new Headers({"X-Requested-With":"XMLHttpRequest"})}).then(function(e){return e.json()}).then(function(e){t.setState({isLoading:!1,items:e.data.items,total:e.data.statistics.total,totalSum:e.data.statistics.total_cost,pageCount:Math.ceil(e.data.statistics.total/t.props.perPage)})},function(e){t.setState({error:e,isLoading:!1})})}},{key:"fetchItem",value:function(e){var t=this,n="".concat(g.a.getLocation(),"/shop-admin-panel/failed-orders/get-order?id=").concat(e);fetch(n,{headers:new Headers({"X-Requested-With":"XMLHttpRequest"})}).then(function(e){return e.json()}).then(function(e){t.setState({isLoading:!1,item:e.data.item})},function(e){t.setState({error:e,isLoading:!1})})}},{key:"handlePageClick",value:function(e){var t=this;this.setState({error:null,offset:Math.ceil(e.selected*this.props.perPage)},function(){t.fetchItems()})}},{key:"handleSort",value:function(e){var t=this;this.setState({error:null,orderBy:e,offset:0,isDescending:!this.state.isDescending},function(){t.fetchItems()})}},{key:"handleFilter",value:function(e,t,n){var a=this;this.setState({error:null,filterBy:e,filterStart:t,filterEnd:n,offset:0},function(){a.fetchItems()})}},{key:"handleFilterClose",value:function(){var e=this;this.setState({error:null,filterBy:"",filterStart:"",filterEnd:"",offset:0},function(){e.fetchItems()})}},{key:"handleShowItem",value:function(e){var t=this;this.setState({error:null,isLoading:!0,showItem:!0},function(){t.fetchItem(e)})}},{key:"handleCloseItem",value:function(){this.setState({showItem:!1})}},{key:"render",value:function(){var e=this.state,t=e.error,n=e.isLoading,a=e.showItem,l=e.item,r=e.items,o=e.orderBy,i=e.isDescending,c=e.filterBy,s=e.filterStart,u=e.filterEnd,d=e.total,f=e.totalSum,m=e.pageCount,h=e.offset;return a?b.a.createElement(P,{error:t,isLoading:n,item:l,onClose:this.handleCloseItem}):b.a.createElement(k,{error:t,isLoading:n,items:r,orderBy:o,isDescending:i,filterBy:c,filterName:g.a.getFilterName(c),filterStart:s,filterEnd:u,totalItems:d,totalSum:f,pageCount:m,offset:h,onFilterCloseClick:this.handleFilterClose,onTableSortClick:this.handleSort,onTableFilterClick:this.handleFilter,onTableRowClick:this.handleShowItem,onPageClick:this.handlePageClick})}}]),n}(),L=(n(38),document.getElementById("page-failed-orders"));L&&l.a.render(b.a.createElement(x,{perPage:10}),L)},38:function(e,t,n){},59:function(e,t,n){}});